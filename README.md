易语言高性能LZ77压缩模块

📌 概述
本模块实现了一个基于 LZ77 变种的无损压缩算法，专为易语言设计，在保证安全性的前提下进行了深度性能优化。核心思想是用哈希表快速查找3字节以上的重复数据串，并以 [2字节偏移 + 1字节长度] 的紧凑格式替换原始重复串，从而达到压缩目的。

代码经过多轮迭代，修复了指针越界、整数除法误判等致命问题，并引入了动态哈希表、快速失败机制、哈希表指针化等高级优化，能够在极短时间内识别高熵（不可压缩）数据并快速返回，避免无效计算。

✨ 核心特性
动态2的幂次哈希表：根据数据大小自动调整哈希表容量（1M~16M项），并用位运算替代取模，大幅提升哈希计算速度。

哈希表指针化读写：使用 指针到整数 和 写到内存 直接操作哈希表内存，消除数组下标检查和 DLL 调用开销，循环中提速 10%~20%。

双重快速失败机制：

膨胀率检查：动态阈值（130%/120%/112%），延迟到一定数据量后开始，避免早期误判。

匹配率检查：全局累计匹配次数与浮点数除法，精准识别高熵文件，阈值按文件大小分级（0.3%~0.8%）。

三分支哈希计算：根据位置自动选择预计算数组、指针快速读取或逐字节安全读取，平衡速度与安全。

严格的边界保护：所有内存访问均在有效范围内，彻底杜绝越界崩溃。

预计算内存控制：超大数据自动禁用预计算，防止内存爆炸。

清晰的分组标志位：每8个数据块使用1字节标志位，格式紧凑。

🔧 算法原理（LZ77变种）
滑动窗口：大小固定为 4096 字节，只查找当前处理位置之前 4KB 范围内的重复串。

哈希索引：用当前3字节计算 24 位哈希值，并映射到哈希表（大小总是 2 的幂）。

匹配查找：

若哈希表中存在之前出现过的相同 3 字节位置，且偏移 ≤ 4096，则调用 RtlCompareMemory 获取实际匹配长度（最大 255）。

匹配长度 ≥ 3 时，用 2字节偏移 + 1字节长度 替换原始数据。

输出格式：

每 8 个数据块为一组，先输出 1 字节标志位（bit=1 表示该块是匹配对，bit=0 表示原始字节）。

匹配对：偏移量低8位 + 偏移量高8位 + 匹配长度。

原始字节：直接输出 1 字节。

压缩结果：首字节为 1 表示压缩成功，后续为压缩数据；首字节为 0 表示未压缩（原始数据直接返回）。

📦 API 说明
e
.子程序 压缩_字节集_预计算, 字节集, 公开
.参数 原始数据, 字节集      ' 待压缩的数据
.参数 启用预计算, 逻辑型, 可空  ' 是否启用预计算哈希键（大文件推荐真，小文件可假）
返回值（字节集）：

第一个字节为 1：压缩成功，后续数据为压缩格式。

第一个字节为 0：未压缩（数据不可压缩或压缩失败），后续为原始数据。
